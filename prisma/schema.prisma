// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Movie {
  id               Int              @id @default(autoincrement())
  original_title   String           @unique
  tmdb_id          Int              @unique
  poster_path      String?         
  backdrop_path    String?         
  release_date     String?
  runtime          Int?
  tagline          String?         
  overview         String?         
  users            User[]
  notification     Notification[]
  movieRating      MovieRating[]
}  
  
model User {  
  id               Int              @id @default(autoincrement())
  email            String           @unique
  user_name        String           @unique
  password         String
  movies           Movie[]
  notifications    Notification[]
  followedBy       User[]           @relation("UserFollows", references: [id])
  following        User[]           @relation("UserFollows", references: [id])
  notification     Notification[]   @relation("FollowedUser")
  movieRating      MovieRating[]
  resetToken       String?          @unique
  activationToken  String?          @unique
}

model Notification {
  id               Int              @id @default(autoincrement())
  movie            Movie?           @relation(fields: [movieId], references: [id])
  movieId          Int? 
  movieRating      MovieRating?     @relation(fields: [movieRatingId], references: [id])
  movieRatingId    Int? 
  user             User?            @relation(fields: [userId], references: [id])
  userId           Int? 
  followedUser     User?            @relation("FollowedUser", fields: [followedUserId], references: [id])
  followedUserId   Int? 
  action           String 
  value            String?
  watched          Boolean          @default(false)
} 
  
model MovieRating { 
  id               Int              @id @default(autoincrement())
  value            Int              @default(0)
  user             User             @relation(fields: [userId], references: [id])
  userId           Int 
  movie            Movie            @relation(fields: [movieId], references: [id])
  movieId          Int
  Notification     Notification[]
}
